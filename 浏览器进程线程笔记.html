<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器进程线程笔记 | Thyiad&#39;s notes</title>
    <meta name="generator" content="VuePress 1.7.1">
    <meta name="description" content="I read, I write">
    <link rel="preload" href="/assets/css/0.styles.992cb7aa.css" as="style"><link rel="preload" href="/assets/js/app.73419036.js" as="script"><link rel="preload" href="/assets/js/2.4cec8200.js" as="script"><link rel="preload" href="/assets/js/23.751a7d20.js" as="script"><link rel="prefetch" href="/assets/js/10.c556e963.js"><link rel="prefetch" href="/assets/js/11.4d984aee.js"><link rel="prefetch" href="/assets/js/12.b834128f.js"><link rel="prefetch" href="/assets/js/13.fe245308.js"><link rel="prefetch" href="/assets/js/14.52669448.js"><link rel="prefetch" href="/assets/js/15.4c140842.js"><link rel="prefetch" href="/assets/js/16.ba292595.js"><link rel="prefetch" href="/assets/js/17.3ddaacb1.js"><link rel="prefetch" href="/assets/js/18.dae9d5f5.js"><link rel="prefetch" href="/assets/js/19.9c10ab5f.js"><link rel="prefetch" href="/assets/js/20.1ee84732.js"><link rel="prefetch" href="/assets/js/21.c7ac0932.js"><link rel="prefetch" href="/assets/js/22.8153da81.js"><link rel="prefetch" href="/assets/js/24.9430a61a.js"><link rel="prefetch" href="/assets/js/25.96a76ef0.js"><link rel="prefetch" href="/assets/js/3.79166e16.js"><link rel="prefetch" href="/assets/js/4.09fd2c39.js"><link rel="prefetch" href="/assets/js/5.fc791712.js"><link rel="prefetch" href="/assets/js/6.ffe6f60a.js"><link rel="prefetch" href="/assets/js/7.9fbf953a.js"><link rel="prefetch" href="/assets/js/8.f546e8a2.js"><link rel="prefetch" href="/assets/js/9.c38d618a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.992cb7aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Thyiad's notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h3> <p>陆陆续续看过很多浏览器的进程线程资料，此处仅为翻看资料的随手笔记，不做具体描述</p> <h3 id="浏览器是多进程的"><a href="#浏览器是多进程的" class="header-anchor">#</a> 浏览器是多进程的</h3> <ul><li>主进程
<blockquote><p>管理协调各个页面，创建/销毁各个页面进程，网络资源的管理、下载等</p></blockquote></li> <li>插件进程</li> <li>GPU进程</li> <li>渲染进程
<blockquote><p>每个tab都有自己独立的进程</p></blockquote></li></ul> <h3 id="渲染进程"><a href="#渲染进程" class="header-anchor">#</a> 渲染进程</h3> <ul><li>GUI渲染线程</li> <li>JS引擎线程</li> <li>事件触发线程
<blockquote><p>即 event loop 线程</p></blockquote></li> <li>定时触发器线程
<blockquote><p>setTimeout, setInterval
规范中规定延时小于4ms，也会当成4ms处理</p></blockquote></li> <li>http请求线程
<blockquote><p>常规的都是单域名限制最大6个，所有域名最大数量暂未了解到
可以分散到多个域名，http2.0的多路复用也能变相解决该问题</p></blockquote></li></ul> <h3 id="js线程与gui线程互斥"><a href="#js线程与gui线程互斥" class="header-anchor">#</a> JS线程与GUI线程互斥</h3> <p>防止渲染前后DOM数据不一致，耗时的作需要使用web worker</p> <blockquote><p>通过postMessage 通信</p></blockquote> <h3 id="浏览器渲染基本过程"><a href="#浏览器渲染基本过程" class="header-anchor">#</a> 浏览器渲染基本过程</h3> <ul><li>解析html生成dom树</li> <li>解析css构建render树（csss树结合dom树合并成render树）</li> <li>布局render树（layout/reflow），计算尺寸、位置</li> <li>绘制render树，绘制页面像素</li> <li>发送到GPU，交由GPU显示</li></ul> <h3 id="硬件加速"><a href="#硬件加速" class="header-anchor">#</a> 硬件加速</h3> <p>渲染图层分为两种：普通图层、复合图层</p> <blockquote><p>Chrome源码调试 -&gt; More Tools -&gt; Rendering -&gt; Layer borders，黄色的边框为复合图层</p></blockquote> <p>硬件加速即指复合图层</p> <blockquote><p>translate3d、translateZ、opacity、will-chang、&lt;video /&gt;、&lt;iframe /&gt;、&lt;canvas /&gt;、&lt;webgl /&gt;</p></blockquote> <p>复合图层独立于普通文档流中，修改后不会影响普通文档流</p> <blockquote><p>尽可能使复合图层层级高，浏览器默认会将高于复合图层的文档变为复合图层
大量使用导致资源消耗过度，页面反而会更卡</p></blockquote> <h3 id="event-loop"><a href="#event-loop" class="header-anchor">#</a> event loop</h3> <ul><li>JS引擎线程</li> <li>事件触发线程</li> <li>定时触发器线程</li></ul> <blockquote><p>事件触发器维护着一个任务队列，当JS引擎空闲时就会来取任务执行
定时器触发后就会往事件触发器中推入任务</p></blockquote> <h3 id="macrotask与microtask"><a href="#macrotask与microtask" class="header-anchor">#</a> macrotask与microtask</h3> <p>优先级：microtask&gt;macrotask</p> <blockquote><p>microtask: Promise、process.nextTick
macrotask: 主代码、setTimeout、setInterval</p></blockquote> <p>参考资料：
https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/
https://segmentfault.com/a/1190000012925872</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.73419036.js" defer></script><script src="/assets/js/2.4cec8200.js" defer></script><script src="/assets/js/23.751a7d20.js" defer></script>
  </body>
</html>
